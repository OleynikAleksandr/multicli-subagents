# SubAgent Architecture Refactoring

**–î–∞—Ç–∞:** 2025-12-06  
**–°—Ç–∞—Ç—É—Å:** –ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏  
**Version:** 0.0.5-dev

---

## 1. –ü—Ä–æ–±–ª–µ–º–∞

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–æ–∫** ‚Äî SubAgents –¥–ª—è Claude Code —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `.codex/subagents/` –≤–º–µ—Å—Ç–æ –µ–¥–∏–Ω–æ–π –ø–∞–ø–∫–∏
2. **–†–∞–∑–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –Ω–µ—Ç —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ (Codex vs Claude)
3. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ñ–æ—Ä–º–∞—Ç manifest.json** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `triggers[]` –≤–º–µ—Å—Ç–æ `description` —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
4. **–ù–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è Main Agents** ‚Äî –ø—Ä–∏ –¥–µ–ø–ª–æ–µ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è slash-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–∑–æ–≤–∞ SubAgents
5. **UI –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏** ‚Äî –Ω–µ—Ç –≤—ã–±–æ—Ä–∞ vendor, –µ—Å—Ç—å –ª–∏—à–Ω–∏–µ –ø–æ–ª—è

---

## 2. –†–µ—à–µ–Ω–∏–µ

### 2.1 –ï–¥–∏–Ω–∞—è –ø–∞–ø–∫–∞ SubAgents

–í—Å–µ SubAgents —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **`.subagents/`** (project-level) –∏–ª–∏ **`~/.subagents/`** (global):

```
.subagents/
‚îú‚îÄ‚îÄ manifest.json           # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ translator/
‚îÇ   ‚îî‚îÄ‚îÄ translator.md       # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ code-reviewer/
    ‚îî‚îÄ‚îÄ code-reviewer.md
```

### 2.2 –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç manifest.json

```json
{
  "version": "1.0",
  "agents": [
    {
      "name": "translator",
      "description": "Translates text between languages. Use for: translate, –ø–µ—Ä–µ–≤–µ–¥–∏, –ø–µ—Ä–µ–≤–æ–¥.",
      "commands": {
        "start": "cd \"$CWD\" && codex exec --skip-git-repo-check --full-auto \"First, read .subagents/translator/translator.md. Then: $TASK\"",
        "resume": "cd \"$CWD\" && codex exec resume $SESSION_ID \"$ANSWER\""
      }
    }
  ]
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- `triggers[]` ‚Üí –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ `description`
- –î–æ–±–∞–≤–ª–µ–Ω –æ–±—ä–µ–∫—Ç `commands` —Å `start` –∏ `resume`
- –£–±—Ä–∞–Ω–æ –ø–æ–ª–µ `vendor` ‚Äî –≤–∏–¥–µ–Ω –∏–∑ –∫–æ–º–∞–Ω–¥—ã

### 2.3 –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Main Agents –ø—Ä–∏ Deploy

–ü—Ä–∏ –¥–µ–ø–ª–æ–µ –≤ –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞—é—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –û–ë–û–ò–• Main Agents:

**–î–ª—è Codex CLI** ‚Äî `.codex/prompts/call-subagent.md`:
```markdown
---
description: Call a SubAgent from .subagents/ folder
argument-hint: NAME=<agent> TASK=<description>
---

# Call SubAgent

1. Read `.subagents/manifest.json`
2. Find agent by $NAME
3. Execute `commands.start` with $TASK
4. If agent asks questions, use `commands.resume`
```

**–î–ª—è Claude Code CLI** ‚Äî `.claude/commands/call-subagent.md`:
```markdown
---
description: Call a SubAgent from .subagents/ folder
allowed-tools: Bash, Read
---

# Call SubAgent

$ARGUMENTS

1. Read `.subagents/manifest.json`
2. Find agent matching the task
3. Execute `commands.start`
4. Handle follow-ups with `commands.resume`
```

**AGENTS.md / CLAUDE.md** ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–µ–∫—Ü–∏—è Auto-Routing:
```markdown
## SubAgent Auto-Routing

Before starting any task, check `.subagents/manifest.json`.
If user's request matches any agent's description, delegate to that SubAgent.
```

---

## 3. Proposed Changes

### 3.1 Model Changes

#### [MODIFY] [sub-agent.ts](file:///Users/oleksandroliinyk/VSCODE/multicli-subagents/src/models/sub-agent.ts)

```diff
export interface SubAgent {
  id: string;
  name: string;
- description: string;
- triggers: string[];
+ description: string;  // Now includes trigger keywords
  instructions: string;
+ commands: {
+   start: string;
+   resume: string;
+ };
  createdAt: Date;
  updatedAt: Date;
}
```

#### [MODIFY] [types.ts](file:///Users/oleksandroliinyk/VSCODE/multicli-subagents/src/models/types.ts)

–û–±–Ω–æ–≤–∏—Ç—å —Ç–∏–ø—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ.

---

### 3.2 Deploy Service Changes

#### [MODIFY] [deploy-service.ts](file:///Users/oleksandroliinyk/VSCODE/multicli-subagents/src/core/deploy-service.ts)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. –ü–∞–ø–∫–∞ `.codex/subagents/` ‚Üí `.subagents/`
2. –ü—Ä–∏ –¥–µ–ø–ª–æ–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å:
   - `.subagents/{name}/{name}.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - `.subagents/manifest.json` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å/–¥–æ–±–∞–≤–∏—Ç—å –∞–≥–µ–Ω—Ç–∞
   - `.codex/prompts/call-subagent.md` ‚Äî slash-–∫–æ–º–∞–Ω–¥–∞ –¥–ª—è Codex
   - `.claude/commands/call-subagent.md` ‚Äî slash-–∫–æ–º–∞–Ω–¥–∞ –¥–ª—è Claude
3. –û–±–Ω–æ–≤–∏—Ç—å AGENTS.md / CLAUDE.md —Å —Å–µ–∫—Ü–∏–µ–π Auto-Routing

---

### 3.3 UI Complete Redesign

> [!IMPORTANT]
> –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ UI –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX

#### 3.3.1 –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–¢–µ–º–∞:** –¢—ë–º–Ω–∞—è (VS Code dark theme colors)
- **–ü–æ–ª—è –≤–≤–æ–¥–∞:** –ë–æ–ª—å—à–∏–µ, —É–¥–æ–±–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ö–Ω–æ–ø–∫–∏:** –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏
- **–ù–µ—Ç —Ö–∞–æ—Å–∞:** –ß—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ "Create" vs "Browse"

#### 3.3.2 Home Screen

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 SubAgent Manager                ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ    ‚îÇ                 ‚îÇ  ‚îÇ                 ‚îÇ    ‚îÇ
‚îÇ    ‚îÇ  ‚ûï CREATE NEW  ‚îÇ  ‚îÇ  üìã BROWSE      ‚îÇ    ‚îÇ
‚îÇ    ‚îÇ                 ‚îÇ  ‚îÇ                 ‚îÇ    ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 3.3.3 Create Screen

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚Üê Back                    Create New SubAgent  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  Name                                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ translator                                 ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  Description (include keywords for routing)    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Translates text between languages.        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Use for: translate, –ø–µ—Ä–µ–≤–µ–¥–∏, –ø–µ—Ä–µ–≤–æ–¥...  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  Sub Agent Vendor                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ ‚óã Codex CLI    ‚óè Claude Code CLI          ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚ÑπÔ∏è CLI that will execute this Sub Agent       ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  Instructions                                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ üìù Create Instructions in Editor          ‚îÇ ‚îÇ‚Üê Opens VS Code editor
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚ö†Ô∏è "Create, save and close the file"          ‚îÇ‚Üê Blinks if file open
‚îÇ                                                 ‚îÇ
‚îÇ  Generated Commands (read-only)                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ start: cd "$CWD" && codex exec ...        ‚îÇ ‚îÇ
‚îÇ  ‚îÇ resume: cd "$CWD" && codex exec resume... ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê            ‚îÇ
‚îÇ         ‚îÇ     üíæ SAVE AGENT       ‚îÇ            ‚îÇ‚Üê Disabled if temp file open
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
‚îÇ                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Workflow —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π:**
1. –ö–ª–∏–∫ "Create Instructions in Editor"
2. –°–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª: `.subagents/.tmp/{agent-name}_TEMP.md`
3. –§–∞–π–ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ VS Code —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
4. –ö–Ω–æ–ø–∫–∞ "Save Agent" –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ê
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∏–≥–∞—é—â–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ: "Create, save and close the file"
6. –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞ ‚Üí –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞–±–∏—Ä–∞–µ—Ç—Å—è ‚Üí temp —Ñ–∞–π–ª —É–¥–∞–ª—è–µ—Ç—Å—è
7. –ö–Ω–æ–ø–∫–∞ "Save Agent" —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

#### 3.3.4 Browse Screen

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚Üê Back                       Browse SubAgents  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ üì• Import .subagent file                  ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üåê translator           [Codex CLI]     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Translates text between languages...    ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ ‚úèÔ∏è Edit ‚îÇ üöÄ Deploy ‚îÇ üì§ Export ‚îÇ üóëÔ∏è Delete‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ üîç code-reviewer        [Claude CLI]    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Reviews code for quality...             ‚îÇ   ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§   ‚îÇ
‚îÇ  ‚îÇ ‚úèÔ∏è Edit ‚îÇ üöÄ Deploy ‚îÇ üì§ Export ‚îÇ üóëÔ∏è Delete‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Deploy Modal (–ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ Deploy):**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            Deploy "translator"                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  Target:                                        ‚îÇ
‚îÇ  ‚óã Project (.subagents/ in workspace)          ‚îÇ
‚îÇ  ‚óã Global (~/.subagents/)                      ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ     Cancel      ‚îÇ  ‚îÇ     Deploy      ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 3.3.5 File Structure Changes

**Webview UI:**
- [DELETE] `agent-list.tsx` + `agent-editor.tsx` (–æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ —Ö–∞–æ—Å–µ)
- [NEW] `home-screen.tsx` ‚Äî –¥–≤–µ –∫–Ω–æ–ø–∫–∏ Create/Browse
- [NEW] `create-screen.tsx` ‚Äî —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- [NEW] `browse-screen.tsx` ‚Äî —Å–ø–∏—Å–æ–∫ + –¥–µ–π—Å—Ç–≤–∏—è
- [NEW] `deploy-modal.tsx` ‚Äî –º–æ–¥–∞–ª–∫–∞ –≤—ã–±–æ—Ä–∞ target
- [MODIFY] `App.tsx` ‚Äî —Ä–æ—É—Ç–∏–Ω–≥ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- [MODIFY] `index.css` ‚Äî —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞, –±–æ–ª—å—à–∏–µ –ø–æ–ª—è

**Extension:**
- [NEW] `src/commands/open-temp-instructions.ts` ‚Äî –æ—Ç–∫—Ä—ã—Ç–∏–µ temp —Ñ–∞–π–ª–∞
- [MODIFY] `src/webview/webview-provider.ts` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç webview

---

## 4. Verification Plan

### 4.1 Existing Tests

```bash
npm run test   # Offline unit tests for LibraryService, SubAgentService, Providers
```

### 4.2 Manual Verification

1. **F5** ‚Üí Extension Development Host
2. **Cmd+Shift+P** ‚Üí "SubAgent Manager: Open"
3. –°–æ–∑–¥–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ "test-translator" —Å vendor Codex
4. Deploy to Project ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - `.subagents/test-translator/test-translator.md` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - `.subagents/manifest.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–≥–µ–Ω—Ç–∞ —Å `commands`
   - `.codex/prompts/call-subagent.md` —Å–æ–∑–¥–∞–Ω
   - `.claude/commands/call-subagent.md` —Å–æ–∑–¥–∞–Ω
5. –°–æ–∑–¥–∞—Ç—å –∞–≥–µ–Ω—Ç–∞ "test-reviewer" —Å vendor Claude
6. –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏
7. Export ‚Üí Import ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å

---

## 5. User Review Required

> [!IMPORTANT]
> **Breaking Change:** –§–æ—Ä–º–∞—Ç `manifest.json` –∏–∑–º–µ–Ω—è–µ—Ç—Å—è.
> –°—Ç–∞—Ä—ã–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã —Å `triggers[]` –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–†–µ—à—ë–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
- ‚úÖ –ü–∞–ø–∫–∞ `.subagents/` ‚Äî —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
- ‚úÖ Global deploy `~/.subagents/` ‚Äî –Ω—É–∂–µ–Ω —Å–µ–π—á–∞—Å
- ‚è≥ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –º–∞–Ω–∏—Ñ–µ—Å—Ç–æ–≤ ‚Äî –Ω–µ –Ω—É–∂–Ω–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç)

---

## 6. Summary of Changes

**Model:**
- `sub-agent.ts` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `commands.start/resume`, —É–±—Ä–∞—Ç—å `triggers[]`
- `types.ts` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Ç–∏–ø—ã

**Deploy Service:**
- `deploy-service.ts` ‚Äî –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞ `.subagents/`, —Å–æ–∑–¥–∞–Ω–∏–µ slash-–∫–æ–º–∞–Ω–¥

**UI (–ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞):**
- `home-screen.tsx` ‚Äî –Ω–æ–≤—ã–π, –¥–≤–µ –∫–Ω–æ–ø–∫–∏ Create/Browse
- `create-screen.tsx` ‚Äî –Ω–æ–≤—ã–π, —Ñ–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `browse-screen.tsx` ‚Äî –Ω–æ–≤—ã–π, —Å–ø–∏—Å–æ–∫ + –¥–µ–π—Å—Ç–≤–∏—è
- `deploy-modal.tsx` ‚Äî –Ω–æ–≤—ã–π, –≤—ã–±–æ—Ä target
- `App.tsx` ‚Äî —Ä–æ—É—Ç–∏–Ω–≥ –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
- `index.css` ‚Äî —Ç—ë–º–Ω–∞—è —Ç–µ–º–∞, –±–æ–ª—å—à–∏–µ –ø–æ–ª—è

**Extension:**
- `open-temp-instructions.ts` ‚Äî –Ω–æ–≤—ã–π, –æ—Ç–∫—Ä—ã—Ç–∏–µ temp —Ñ–∞–π–ª–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ

**Estimated effort:** ~15 micro-tasks



